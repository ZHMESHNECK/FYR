# FYR
## find_your_roof
это бот который позволит вам искать объявления об аренде жилья сразу на 3-ох сайтах с помощью одной кнопки, что позволит вам быстро проверить новинки которые появились


## идея
Пообщавшись со своим другом который уже много раз снимал квартиру, я понял что хорошие объявления про аренду жилья долго не висят на сайте, их разбирают очень быстро. Поэтому  мне пришла в голову мысль создать бота который будт искать объявления сразу на несколький сайтах экономя время. Например можно ехать в метро и нажать на 1 кнопку бота чтоб получить желаемый результат вместо того чтоб заходить на разные сайты и заново задавать параметры. В ходе разговора я узнал какие сайты лучше всего подходят для поиска:
- OLX.ua
- rieltor.ua
- country.ua

## функционал

- Регистрация ( в БД хранятся такие данные )
    - id юзера
    - город для поиска
    - цена min/max
    - количество комнат (max 3)
    - этаж min/max
    - желаемая сортировка
    - после каждого поиска даётся "бан" на 1 минуту для предотвращения спама
- Возможность менять сохранённые данные
- удобные кнопки для быстрого ввода

## требования
- Python 3.9 и выше
- PostgreSQL

## установка
1. Откройте свою IDE
2. Устаноите проект с помощью терминала и команды 
```
git clone https://github.com/ZHMESHNECK/FYR.git
```
3. перейдите в папку FYR командой
```
cd FYR
```
4. Установите виртуальную среду. Например:
```
python -m venv venv
```
5. скачиваем библиотеки
```
pip install -r requirements.txt
``` 
6. Создаём файл `.env` за папкой FYR

![Alt text](media/screen/show_env.png),

- содержимое `.env` выглядит таким образом
```
TOKEN='YOUR_API_KEY'

# PostgreSQL
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=NAME_TABLE
POSTGRES_USER=USER_NAME
POSTGRES_PASSWORD=PASSWORD
```
7. Переходим в файл `FYR_bot.py` и запускаем 
8. Готово! :heavy_check_mark: приятного пользования
![Alt text](media/screen/finally.png)

## Что в планах
- [ ] Интеграция Docker
- [ ] Добавить возможность выбора региона
- [ ] Возможность сохранять объявления

## Источники
- https://www.youtube.com/@Redlyy
- https://www.youtube.com/@PythonToday

## Спасибо
- [vladfraer1](https://t.me/vladfraer1) ( тест )
- [Itkitko](https://t.me/Itkitko) ( тест )
- [TOMAS](https://t.me/Teuieieie) ( тест )

## Обновления

version 1.7.7
- РЕЛИЗ
- Обновлено подключение к БД
- убрана проверка на этаж ( <=20 )
- Улучшен механизм обхода рекламы в olx, rieltor

version 1.7.6
- ПЕРЕХОДНОЕ ОБНОВЛЕНИЕ ( разрыв соединения с DB )
- Улучшен механизм обхода рекламы в country
- мелкие правки

version 1.7.5
- bag fix с неправильным ответом в изменении параметра / начало регистрации isinstance
- Подкоректирован /help
- Добавлена проверка min <= max для цены и этажа в обе "регистрации"
- Добавлена проверка этажа не выше 20-го в обе "регистрации"
- Исправлена генерация ссылки olx ( сортировка )

version 1.7.4
- В одиночном изменении параметра доработан пункт "Пропуск"
- Исправлен баг с не показом объявлений на rieltor
- Изменён return в функции `registration`

version 1.7.3
- Добавлен requirements.txt
- Разработка README.md

version 1.7.2
- Добавлена блокировка на 1 минуту после начала успешного поиска для предотвращения спама
- Проверка на бан в 1 минуту
- Добавлена новая колонка в БД ( время начала поиска )

version 1.7.1
- Доработаны специфичные запросы где меньше 8 объявлений или ничего не найдено за запросом

version 1.7.0
- Изменена система парсинга на olx
    - добавлены 5 рабочих fake_user_agent
- Исправлена ошибка при "отмене" изменений

version 1.6.9
- Добавлена внешка бота
- Исправлен баг при указании цены выше 10к в основной регистрации

version 1.6.8
- Исправлена ошибка при генерации ссылки на rieltor для 2-х комнат

version 1.6.7
- Изменена структура расположения файлов
- Исправлен баг при указании цены выше 10к в изменениях параметров
- Кнопка "Отмена" в изменении 1 параметра теперь работает

version 1.6.6
- Полностью рабочие варианты с rieltor, country

version 1.6.5
- Параметры ссылки для rieltor, country
- Полностью рабочий вариант с olx

version 1.6.4
- Добавлены заготовки городов для генерации ссылок
- Параметры ссылки для olx

version 1.6.2/ 1.6.3
- Изменён тип сроки count_rooms в дб на str
- Добавлены проверки на входящие данные

version 1.6.1
- Добавлена возможность менять параметры у существующего юзера
- Обнаружен баг при указании нескольких комнат

version 1.6
- Рабочая сырая регистрация юзеров без проверок

version 1.5.1
- Изменена архитектура расположения файлов 
- Добавлены заготовки для регистрации и подключении к базе
- Исправлена ошибка по архитектуре import
- Ошибка при подключении к базе данних

version 1.5
- Добавлены заготовки для регистрации юзеров, а так же связь с БД

version 1.4.1
- Добавлена заготовка для olx, генерация ссылки с параметрами
- Исправлены недочёты в генерации ссылки для rieltor

version 1.4
- Добавлена заготовка для rieltor, генерация ссылки с параметрами
- Добавлен config файл с городами

version 1.3
- Обновлён механизм ожидания на olx

version 1.2
- Добавлен сайт country.ua

version 1.1
- Рабочий бот по riel , olx. Параметры по статичному шаблону
